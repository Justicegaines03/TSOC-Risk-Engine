# ===========================================================================
# SOC Risk Engine — Environment Variables
# ===========================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# Or use the bootstrap script which does this automatically:
#   make setup
#
# IMPORTANT: Never commit .env to version control!
# ===========================================================================

# ---------------------------------------------------------------------------
# TheHive Configuration
# ---------------------------------------------------------------------------

# Secret key for TheHive session encryption.
# Generate with: openssl rand -base64 32
# The bootstrap script generates this automatically.
THEHIVE_SECRET=your-secret-key-here

# TheHive 5 API connection (used by the risk engine)
THEHIVE_URL=http://localhost:9000
THEHIVE_API_KEY=your-thehive-api-key-here

# ---------------------------------------------------------------------------
# Cortex Configuration
# ---------------------------------------------------------------------------

# Cortex API connection (used by the risk engine)
CORTEX_URL=http://localhost:9001
CORTEX_API_KEY=your-cortex-api-key-here

# ---------------------------------------------------------------------------
# Risk Engine — General
# ---------------------------------------------------------------------------

# Watch-mode polling interval in seconds.
# The engine checks for unscored cases this often.
WATCH_INTERVAL=30

# ---------------------------------------------------------------------------
# Risk Engine — B2B Scoring Parameters
# ---------------------------------------------------------------------------
# These can also be changed directly in risk_engine/config.py.

# Default asset value in USD when a case has no asset:* tag.
DEFAULT_ASSET_VALUE=50000

# Asset value tiers (configured in config.py):
#   workstation:    $5,000
#   server:         $50,000
#   database:       $500,000
#   critical_infra: $2,000,000

# Sensitivity multipliers (configured in config.py):
#   public:       1.0x
#   internal:     2.0x
#   confidential: 5.0x
#   restricted:   10.0x

# Risk level thresholds (ALE in USD, configured in config.py):
#   Critical: $500,000+
#   High:     $100,000+
#   Medium:   $10,000+
#   Low:      $1,000+
#   Info:     Below $1,000

# ---------------------------------------------------------------------------
# Risk Engine — B2C Consumer Scoring Parameters
# ---------------------------------------------------------------------------
# These can also be changed directly in risk_engine/config.py.

# Exposure type severity weights (0-100, configured in config.py):
#   email_only:      15  (Low — change password, enable MFA)
#   phone:           25  (Moderate — SIM swap risk)
#   credit_card:     40  (Moderate — replaceable, fraud protection)
#   bank_account:    60  (High — direct financial access)
#   drivers_license: 70  (High — synthetic identity risk)
#   medical_records: 80  (Severe — medical identity theft)
#   ssn:             85  (Severe — credit/tax fraud, long recovery)
#   ssn_and_dl:      95  (Critical — full identity takeover)

# Severity level thresholds (0-100 score, configured in config.py):
#   Critical: 80+
#   High:     60+
#   Medium:   35+
#   Low:      15+
#   Info:     Below 15

# ---------------------------------------------------------------------------
# MISP (Optional)
# ---------------------------------------------------------------------------
# MISP integration is configured through the TheHive UI, not here.
# See docs/MISP-INTEGRATION.md for setup instructions.
